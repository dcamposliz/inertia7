<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, maximum-scale=1">

<title>Inertia7: Data Science Projects</title>
<link rel="icon" href="../favicon2.png" type="image/png">
<link rel="shortcut icon" href="../favicon2.ico" type="img/x-icon">

<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,800italic,700italic,600italic,400italic,300italic,800,700,600' rel='stylesheet' type='text/css'>

<link href="../css/bootstrap.css" rel="stylesheet" type="text/css">
<link href="../css/style.css" rel="stylesheet" type="text/css">
<link href="../css/font-awesome.css" rel="stylesheet" type="text/css">
<link href="../css/responsive.css" rel="stylesheet" type="text/css">
<link href="../css/animate.css" rel="stylesheet" type="text/css">
<link href="../css/d3_style.css" rel="stylesheet" type="text/css">
<!--[if IE]><style type="text/css">.pie {behavior:url(PIE.htc);}</style><![endif]-->

<script type="text/javascript" src="../js/jquery.1.8.3.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.js"></script>
<script type="text/javascript" src="../js/jquery-scrolltofixed.js"></script>
<script type="text/javascript" src="../js/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="../js/jquery.isotope.js"></script>
<script type="text/javascript" src="../js/wow.js"></script>
<script type="text/javascript" src="../js/classie.js"></script>
<script type="text/javascript" src="../engines/scripts.js"></script>
<script src="http://cdn.plot.ly/plotly-latest.min.js"></script>


<!--[if lt IE 9]>
    <script src="js/respond-1.1.0.min.js"></script>
    <script src="js/html5shiv.js"></script>
    <script src="js/html5element.js"></script>
<![endif]-->

</head>
</head>
<body>

<!--main-nav-start-->
<nav class="navbar navbar-fixed-top" role="navigation" style="background-color:white"><!--main-nav-start-->
    <div class="container-fluid" style="box-shadow:5px 5px 5px #D3D3D3;">
            <ul class="main-nav">
                <li class="small-logo large-paragraph"><a href="../index.html"><img src="../img/data_logo.png" alt="" width="100px"> Inertia7</a></li>
            </ul>
    </div>
</nav><!--main-nav-end-->


<section class="header-project large-paragraph">
    <div class="container">
        <h1><strong>PROJECT</strong>: PREDICTING THE STOCK MARKET</h1>
        <hr/>
        <p><strong>TIME-SERIES ANALYSIS OF THE S&amp;P 500 STOCK INDEX WITH R</strong></p>
    </div>
</section>


<!-- PROJECT SUMMARY -->
    <section class="main-section xlarge-paragraph">
        <div class="container">
            <h3>
                Contributors: <strong>David A. Campos, Raul Eulogio, Kim Specht, Nathan Fritter</strong>.
            </h3>
            <br/>
            <h3>
                Languages: <strong>R, JavaScript</strong>.
            </h3>
            <br/>
            <h3>
                Published on: <strong>June 2016</strong>.
            </h3>
        </div>
    </section>
    <section class="main-section xlarge-paragraph">
        <div class="container">
            <h2>Project Summary</h2>
            <hr/>
            <p>
                This project focuses on finding the best statistical-learning model to predict future values for the <strong>S&amp;P 500 Stock Index</strong>.
            </p>
            <br/>
            <p>
                Understanding the <strong>S&amp;P 500 Stock Index</strong> is highly-relevant in understanding the health of the U.S. economy as it is highly-correlated (statistically) with other U.S. economic indicators such as other stock indices (e.g. the NASDAQ Stock Index and the NYSE Stock Exchange), the U.S. Housing Price Index, and the U.S. Gross Domestic Product (U.S. GDP).
            </p>
            <br/>
            <p>
                Time-series analysis is a basic concept within the field of statistical-learning, which is appropriate for the analysis of the <strong>S&amp;P 500 Stock Index</strong>. 
            </p>
            <br/>
            <p>
                In this project, we carry out this statistical analysis with the power of R and deliver some browser-rich visualizations using with the elegance and flare of the JavaScript libraries d3.js, Plotly, and Shiny.
            </p>
            <br/>
            <p>
                We encourage you to try replicating this project and make your own contributions! You can fork this project on <a href="https://github.com/dcamposliz/dataScience_stockMarket">GitHub</a>.
            </p>
        </div>
        <br/>
        <br/>
        <br/>
        <div class="container xlarge-paragraph">
            <h3>
                Steps:
            </h3>
            <ul>
                <li>
                    <a href="#step1">1. Load packages</a>
                </li>
                <li>
                    <a href="#step2">2. Get Data</a>
                </li>
                <li>
                    <a href="#step3">3. Do Exploratory Analysis</a>
                </li>
                <li>
                    <a href="#step4">4. Build Models</a>
                </li>
                <li>
                    <a href="#step5">5. Derive Conclusions</a>
                </li>
            </ul>
        </div>
        <br/>
        <div class="container xlarge-paragraph">
            <h3>
                Requirements:
            </h3>
            <ul>
                <li>
                    Basic working knowledge of the R programming language, statistics (including time-series analysis), and economics (finance).
                </li>
                <li>
                    R software environment.
                </li>
            </ul>
        </div>
    </section>
<!-- 1. LOAD PACKAGES-->
        <section id="step1" class="main-section xlarge-paragraph">
            <div class="container">
                <h1>1.</h1>
                <hr/>
                <h2>Load Packages</h2>
                <hr/>
                <p>
                    First, we want to load the appropriate packages into our R environment.
                </p>
                <br/>
                <p>
                    For this we use the <code>required()</code> method and include the package names as arguments. Make sure to first install the packages using the <code>install.packages("")</code> method if you haven't done so already.
                </p>
                <br/>
                <code>
                    require(data.table)
                </code>
                <br/>
                <code>
                    require(ggplot)
                </code>
                <br/>
                <code>
                    require(astsa)
                </code>
                <br/>
                <code>
                    require(car)
                </code>
                <br/>
                <code>
                    require(caret)
                </code>
                <br/>
                <code>
                    require(plotly)
                </code>
                <br/>
                <code>
                    require(forecast)
                </code>
                <br/>
                <br/>
                <p>
                    We encourage you to do a quick search on each of these packages to gain context on what they are useful for, and why we are using them here. Pay special attention to the packages <code>astsa</code> and <code>forecast</code>.
                </p>
            </div>
        </section>
<!-- 2. GET DATA -->
    <section id="step2" class="main-section xlarge-paragraph">
        <div class="container">
            <h1>2.</h1>
            <hr/>
            <h2>Get Data</h2>
            <hr/>
            <h3>
                Collecting Data
            </h3>
            <br/>
            <p>
                Now we collect our data. We want to use reliable sources of complete and accurate data. We collected 21 years (1995-2015) of S&amp;P 500 Stock Index data at a monthly frequency (a total of 252 observations) from <a href="https://finance.yahoo.com/q/hp?s=%5EGSPC+Historical+Prices">Yahoo Finance</a>. You can do the same too.
            </p>
            <br/>
            <br/>
            <h3>
                Cleaning Data
            </h3>
            <br/>
            <p>
                We cleaned our data manually using <a href="https://docs.google.com/spreadsheets/d/1STR_wkkIUQVZT-PK0XAdEtmQQnjOzn0DkUPhTyWfolM/edit?usp=sharing">Google Sheets</a>. For this we made sure that all fields contained data (i.e. no missing values) and that the headers (i.e. column names) were labeled appropriately. This can be done programmatically with R, but this is outside of the scope of this project.
            </p>
            <br/>
            <p>
                 We also included a bunch of other variables (for exploratory analysis) such as the NASDAQ Stock Index, the NYSE Stock Exchange, the U.S. Housing Price Index, and the U.S. Gross Domestic Product. Here is our data in file <a href="https://github.com/dcamposliz/timeSeries_sp500/blob/master/data.csv">data.csv</a>, which is ready to be used with R.
            </p>
            <br/>
            <br/>
            <h3>
                Loading Data
            </h3>
            <br/>
            <p>
                Then we must include our data set within our working R environment. For this we use:
            </p>
            <br/>
            <code>
                dataMaster <- read.csv(" ...{PATH_TO}... /data.csv")
            </code>
            <br/>
            <code>
                attach(dataMaster)
            </code>
            <br/>
            <br/>
            <p>
                Now we can call our S&amp;P 500 Stock Index data by typing <code>dataMaster$sp_500</code> into our terminal.
            </p>
        </div>
    </section>
<!-- 3. DO EXPLORATORY ANALYSIS -->
    <section id="step3" class="main-section xlarge-paragraph">
        <div class="container">
            <h1>3.</h1>
            <hr/>
            <h2>
                Do exploratory analysis
            </h2>
            <hr/>
            <p>
                Now we want to get a feel for our data to be able to make inferences as to which models may be appropriate for our prediction. For this, we plot our data and diagnose for trend, seasonality, heteroskedasticity, and stationarity. We go over these concepts in further detail in this section.
            </p>
            <br/>
            <br/>
            <h3>
                Creating time-series data object
            </h3>
            <br/>
            <p>
                Our S&amp;P 500 Stock Index data is in the form of time-series; this means that our data exists over a continuous time interval with equal spacing between every two consecutive measurements. In R we are able to create time-series objects for our data vectors using the <code>ts()</code> method. For this, we select the vector we would like to use as the first argument, and tune the <code>start</code> and <code>freq</code> (frequency) parameters. 

                Then we output the time-series data to the terminal by calling our newly-created time-series object.
            </p>
            <br/>
            <code>
                sp_500 <- ts(dataMaster$sp_500, start=c(1995, 1), freq=12)
            </code>
            <br/>
            <br/>
            <p>
                Then we output the time-series data to the terminal by calling our newly-created time-series object. Notice the nicely formatted data broken down into years and their respective months.
            </p>
            <br/>
            <code>
                sp_500
            </code>
            <br/>
            <br/>
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/timSeriesobject.png" alt=""> 
            </div>
            <br/>
            <br/>
            <br/>
            <h3>
                PLOTTING OUR TIME SERIES
            </h3>
            <br/>
            <p>
                Plotting the data is arguably the most critical step in the exploratory analysis phase. This enables us to make inferences about important components of the time-series data, such as trend, seasonality, heteroskedasticity, and stationarity. Here is a quick summary of each:
            </p>
            <br/>
            <ul>
                <li>
                    <strong>Trend</strong>: we say that a dataset has a trend when it has either a long-term increase or decrease.
                </li>
                <br/>
                <li>
                    <strong>Seasonality</strong>: we say that a dataset has seasonality when it has patterns that repeat over known, fixed periods of time (e.g. monthly, quarterly, yearly).
                </li>
                <br/>
                <li>
                    <strong>Heteroskedasticity</strong>: we say that a data is heteroskedastic when its variability is not constant (i.e. its variance increases or decreases as a function of the explanatory variable).
                </li>
                <br/>
                <li>
                    <strong>Stationarity</strong>: a stochastic process is called stationary if the mean and variance are constant (i.e. their joint distribution does not change over time).
                </li>
            </ul>
            <br/>
                <p>
                    We can plot our <code>sp_500</code> data object in R using the <code>plot()</code> method.
                </p>
            <br/>
            <code>
                plot.ts(sp_500)
            </code>
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/plot_1.png" alt=""> 
            </div>
            <br/>
            <p>
                With a little more 'wrangling' we can plot our data using <a href="https://plot.ly/javascript/">plotly.js</a>, a browser-based data-visualization library written in JavaScript.
            </p>
            <br/>
            <div id="myDiv">
                <script type="text/javascript">
                    makeplot();
                </script>
            </div>
           
            <br/>
            <br/>
            <br/>
            
<!-- BEGINNING OF SUBSECTION -->
        <!-- HEADING -->
            <h3>
                DIAGNOSING THE ACF AND PACF OF OUR TIME-SERIES
            </h3>
            <br/>
        <!-- PARAGRAPH -->            
            <p>
                RELEVANCE OF METHOD?
            </p>
        <!-- CODE -->
            <br/>
            <code>
                acf2(sp_500)
            </code>
            <br/>
        <!-- IMG -->
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/acf2.png" alt=""> 
            </div>
            <br/>
        <!-- IMG INTERPRETATION -->
            <p>
                IMG INTERPRETATION
            </p>
<!-- END OF SUBSECTION -->
            <br/>
            <br/>
            <br/>
<!-- BEGINNING OF SUBSECTION -->
            <h3>
                TRANSFORMING OUR DATA TO ADJUST FOR NON-STATIONARITY
            </h3>
            <br/>
            <p>
                RELEVANCE OF METHOD?
            </p>
            <br/>
            <code>
                diff1 <- diff(sp_500)
            </code>
            <br/>
            <br/>
            <p>
                Next we plot our transformed time-series.
            </p>
            <br/>
            <code>
                plot.ts(diff1, main="Time Series Plot of First Diff")
            </code>
            <br/>
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/plot_diff.png" alt=""> 
            </div>
            <br/>
        <!-- IMG INTERPRETATION -->
            <p>
                IMG INTERPRETATION
            </p>
<!-- END OF SUBSECTION -->
            <br/>
            <br/>
            <br/>
<!-- BEGINNING OF SUBSECTION -->
        <!-- HEADING -->
            <h3>
                DIAGNOSING THE ACF AND PACF OF OUR TRANSFORMED TIME-SERIES
            </h3>
            <br/>
        <!-- PARAGRAPH -->            
            <p>
                RELEVANCE OF METHOD?
            </p>
        <!-- CODE -->
            <br/>
            <code>
                acf2(diff1)
            </code>
            <br/>
        <!-- IMG -->
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/acf2_diff.png" alt=""> 
            </div>
            <br/>
        <!-- IMG INTERPRETATION -->
            <p>
                IMG INTERPRETATION
            </p>
<!-- END OF SUBSECTION -->
            <br/>
            <br/>
            <br/>
<!-- BEGINNING OF SUBSECTION -->
        <!-- HEADING -->
            <h3>
                DIAGNOSING SEASONALITY
            </h3>
            <br/>
        <!-- PARAGRAPH -->            
            <p>
                RELEVANCE OF METHOD?
            </p>
        <!-- CODE -->
            <br/>
            <code>
                seasonplot(sp_500,ylab="S&amp;P Closing Values", xlab="Year", main="Seasonal plot: S&&amp;P Monthly Closing Values",<br/>year.labels=TRUE, year.labels.left=TRUE, col=1:20, pch=19)
            </code>
            <br/>
        <!-- IMG -->
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/seasonalPlot.png" alt=""> 
            </div>
            <br/>
        <!-- IMG INTERPRETATION -->
            <p>
                IMG INTERPRETATION
            </p>
<!-- END OF SUBSECTION -->
            <br/>
            <br/>
            <br/>
<!-- BEGINNING OF SUBSECTION -->
        <!-- HEADING -->
            <h3>
                DIAGNOSING OUR TIME-SERIES DECOMPOSITION
            </h3>
            <br/>
        <!-- PARAGRAPH -->            
            <p>
                RELEVANCE OF METHOD?
            </p>
        <!-- CODE -->
            <br/>
            <code>
                plot(stl(sp_500, s.window = "periodic"), main = "Decomposition for S&P 500")
            </code>
            <br/>
        <!-- IMG -->
            <br/>
            <div align="center">
                <img src="../img/timeSeries_stockMarket_img/decomposition.png" alt=""> 
            </div>
            <br/>
        <!-- IMG INTERPRETATION -->
            <p>
                IMG INTERPRETATION
            </p>
<!-- END OF SUBSECTION -->



        </div>
    </section>
<!-- 4. BUILD MODELS -->
    <section id="step4" class="main-section xlarge-paragraph">
        <div class="container">
            <h1>4.</h1>
            <hr/>
            <h2>Build models</h2>
            <hr/>
            <p>
                !!!!! -----> HOW DO WE START OUR STATISTICAL MODELING FROM WHAT WE LEARNED IN THE EARLIER STAGE?
            </p>
            <hr/>
        </div>
        <br/>
        <br/>
        <div class="container">
            <code>
                someCode() !!!!! -----> WHAT CODE DO WE USE TO RUN THIS MODEL?
            </code>
        </div>
        <br/>
        <br/>
        <!-- ARIMA Model for 2015 -->
        <div class="container">
            <hr/>
            <h3>
                <strong>ARIMA Model</strong>: Checking residuals to be white noise using histogram (training set size: 240)
            </h3>
            <div>
                <a href="https://plot.ly/~raviolli77/18/" target="_blank" title="Histogram of ARIMA Model Residuals" style="display: block; text-align: center;"><img src="https://plot.ly/~raviolli77/18.png" alt="HISTOGRAM OF ARIMA MODEL RESIDUALS" style="max-width: 100%;width: 1554px;"  width="1554" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
                <script data-plotly="raviolli77:18"  src="https://plot.ly/embed.js" async></script>
            </div>
            <hr/>
        </div>
        <br/>
        <!-- Forecasted vs Actual plot -->
        <div class="container">            
            <hr/>
            <h3>
                <strong>ARIMA Model</strong>: One-year Forecast vs. Actual Values of S&amp;P 500 (Jan 2015 - Dec 2015)
            </h3>
            <div>
                <a href="https://plot.ly/~raviolli77/8/?share_key=iDp0M5HdBwbBobMHnQ8s1b" target="_blank" title="ACTUAL VS PREDICTED PLOT" style="display: block; text-align: center;"><img src="https://plot.ly/~raviolli77/8.png?share_key=iDp0M5HdBwbBobMHnQ8s1b" alt="ACTUAL VS PREDICTED PLOT" style="max-width: 100%;width: 1554px;"  width="1554" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
                <script data-plotly="raviolli77:8" sharekey-plotly="iDp0M5HdBwbBobMHnQ8s1b" src="https://plot.ly/embed.js" async></script>
            </div>
            <hr/>
        </div>
    </section>

<!-- 5. DERIVE CONCLUSIONS -->

    <section id="step5" class="main-section xlarge-paragraph">
        <div class="container">
            <h1>5.</h1>
            <hr/>
            <h2>Derive Conclusions</h2>
            <hr/>
            <p>Our conclusion is that the ARIMA model is the best fit for our S&amp;P 500 data set, and yields the best prediction for future values.</p>
        </div>
        <br/>
        <br/>
        <!-- Forecasted vs Actual plot -->
        <div class="container">            
            <hr/>
            <h3>
                <strong>ARIMA Model</strong>: Checking residuals to be white noise using histogram (training set size: 228)
            </h3>
            <div>
                <a href="https://plot.ly/~raviolli77/21/" target="_blank" title="Histogram of 2014-2015 Residuals for ARIMA Model" style="display: block; text-align: center;"><img src="https://plot.ly/~raviolli77/21.png" alt="Histogram of 2014-2015 Residuals for ARIMA Model" style="max-width: 100%;width: 1554px;"  width="1554" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
                <script data-plotly="raviolli77:21"  src="https://plot.ly/embed.js" async></script>
            </div>
            <hr/>
        </div>
        <br/>
        <br/>
        <!-- Forecasted vs Actual plot -->
        <div class="container">            
            <hr/>
            <h3>
                <strong>ARIMA Model</strong>: Two-year Forecast vs. Actual Values of S&amp;P 500 (Jan 2014 - Dec 2015)
            </h3>
            <div>
                <a href="https://plot.ly/~raviolli77/11/" target="_blank" title="Forecasted Vs. Actual Values for 2014-2015" style="display: block; text-align: center;"><img src="https://plot.ly/~raviolli77/11.png" alt="Forecasted Vs. Actual Values for 2014-2015" style="max-width: 100%;width: 1554px;"  width="1554" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
                <script data-plotly="raviolli77:11"  src="https://plot.ly/embed.js" async></script>
            </div>
            <hr/>
        </div>
    </section>
</body>
</html>